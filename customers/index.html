<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kunden-Login | Photon Capture</title>
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="auth-container">
        <div class="auth-box">
            <a href="../index.html" class="logo">Photon<span>-Capture</span></a>

            <div id="error-msg" class="error-message">Benutzername oder Passwort falsch</div>

            <form id="login-form">
                <div class="form-group">
                    <label for="username">Benutzername</label>
                    <input type="text" id="username" class="form-control" required autofocus>
                </div>

                <div class="form-group">
                    <label for="password">Passwort</label>
                    <input type="password" id="password" class="form-control" required>
                </div>

                <button type="submit" class="btn">Anmelden</button>
            </form>

            <div style="margin-top: 2rem;">
                <a href="../admin/users.html"
                    style="color: var(--text-secondary); font-size: 0.8rem; text-decoration: none;">Admin Login</a>
            </div>
        </div>
    </div>

    <!-- users.js removed -->
    <script src="js/main.js"></script>
    <script>
        // Redirect if already logged in
        if (Auth.getUser()) {
            window.location.href = 'gallery.html';
        }

        const loginForm = document.getElementById('login-form');
        const errorMsg = document.getElementById('error-msg');

        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Disable button
            const btn = loginForm.querySelector('button');
            const originalText = btn.textContent;
            btn.disabled = true;
            btn.textContent = 'Wird gepr√ºft...';

            const success = await Auth.login(username, password);

            if (success) {
                window.location.href = 'gallery.html';
            } else {
                errorMsg.style.display = 'block';
                btn.disabled = false;
                btn.textContent = originalText;
            }
        });
    </script>
</body>

</html>